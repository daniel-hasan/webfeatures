{% extends "../bases/base_main_site.html" %}

{% block content %}
	<section class="dataset-section">
		<h1>Upload a compressed file</h1>
		<form enctype="multipart/form-data" method="post" name='file_dataset' class="form">
			{% csrf_token %}
			<input name="file_dataset" type="file">
			{% for field in form %}
				{% ifequal field.label "Format" %}
					<span>Format Dataset:</span>
				{% endifequal %}
			
				{% ifequal field.label "Feature set" %}
					<span>Feature Set Dataset: </span>
				{% endifequal %}
				<div>
					{{ field }}
				</div>
				{% for error in field.errors %}
					<p class="erro-p">{{ error }}</p>
				{% endfor %}
			{% endfor %}						
			<button type="submit" class="submit_button">Submit</button>
		</form>
	</section>
	<table class="dataset-list">
		<thead>
    		<tr>
    			<th>Name</th>
    			<th>Status</th>
    			<th>Submitted date</th>
    			<th>Valid until</th>
    			<th>Feature Set</th>
    			<th>Text Format</th>
    			<th>Download</th>
    		</tr>
    	</thead>
    	<tbody>
			{% for dataset in dataset_list|dictsortreversed:"dat_submitted" %}
   				<tr>
    				<td>{{ dataset.nam_dataset }}</td>
    				<td>{{ dataset.status }}</td>
    				<td>{{ dataset.dat_submitted }}</td>
  	  				<td>{{ dataset.dat_valid_until }}</td>
    				<td>{{ dataset.feature_set }}</td>
    				<td>{{ dataset.format.name }}</td>
					<td><a href="{% url "download_result" dataset.id "json" %}">json</a> <a href="{% url "download_result" dataset.id "xls" %}">xls</a></td>
					<td>
						<form action="{% url "dataset_delete" dataset.id %}" method="post">
							{% csrf_token %}
         					<button class="btn btn-danger" id="delete">Delete</button>
         				</form>
					</td>
					
    			</tr>
				{% empty %}
				<tr>
					<td>-----</td>
					<td>--------</td>
					<td>-----------------</td>
					<td>------------</td>
					<td>-------------</td>
					<td>--------------</td>
				</tr>
			{% endfor %}
		</tbody>
	</table>
	<!-- <script type="text/javascript">
		let mapFeatHTMLperFeatSet = {1: ["feature HTML1"], 2: ["feature HTML2"], 3: ["feature HTML3"]};
		
		//Obtém o único botão do tipo submit da página.
		let submit_button = document.querySelector('.submit_button');
		
		//Ao clicar no botão, 
		submit_button.addEventListener('click', function() {
			{% for id_featset, arr_feat_names in map_feathtml.items %}
			console.log({{id_featset}});
			console.log({{arr_feat_names}});
				let ArrayFeatNames = Object.getPrototypeOf({{ arr_feat_names }});
				console.log(ArrayFeatNames);
				//Se o id do feature set for igual a 1 (text_plain), 
				{% for nam_feature in arr_feat_names %} {
					//{% ifequal id_featset 1 %}
						console.log({{ nam_feature }});
					//{% endifequal %}
				alert('Não funcionou');
				{% endfor %}
			{% endfor %}
		})
	</script>-->
{% endblock %}
